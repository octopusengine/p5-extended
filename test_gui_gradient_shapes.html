<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="dark.css">
<script src="js/p5.min.js"></script>
<script src="js/box_gui.js"></script>
</head>
<body>

<script>
// sketch.js

let myEffectShape; // Renamed instance to myEffectShape

// Colors defined as p5.Color objects
let backgroundColorHSB;
let shadowColorHSB;

let squareStartHSB;
let squareEndHSB;

let circleStartRGB;
let circleEndRGB;

let triangleStartHSB;
let triangleEndHSB;

function setup() {
  createCanvas(800, 800);
  angleMode(DEGREES);
  rectMode(CENTER);
  noStroke();

  // --- Define colors for HSB mode ---
  colorMode(HSB, 360, 100, 100, 100);
  backgroundColorHSB = color(230, 30, 23);
  shadowColorHSB = color(230, 30, 18, 100);
  squareStartHSB = color(310, 100, 100, 100);
  squareEndHSB = color(250, 100, 100, 100);
  triangleStartHSB = color(60, 100, 90, 100);
  triangleEndHSB = color(90, 100, 70, 100);

  // --- Define colors for RGB mode ---
  colorMode(RGB, 255);
  circleStartRGB = color(255, 100, 0, 255);
  circleEndRGB = color(200, 0, 255, 255);

  // Create instance of EffectShape class
  myEffectShape = new EffectShape(this); // Renamed instance
  myEffectShape.setShadowColor(shadowColorHSB);

  // At the end of setup, set default colorMode for `draw` back to HSB
  colorMode(HSB, 360, 100, 100, 100);
}

function draw() {
  // Set global color mode to HSB for background and HSB objects
  colorMode(HSB, 360, 100, 100, 100);
  background(backgroundColorHSB);

  // --- Square (HSB gradient, HSB shadow, no blur) ---
  push();
  translate(width * 0.25, height / 2);
  rotate(frameCount * 0.5);
  let s = 150;
  myEffectShape.setShadowColor(shadowColorHSB);
  myEffectShape.blur(false); // Turn off blur for this object
  myEffectShape.applyEffects(); // Apply effects (shadow only)
  myEffectShape.linearGradient(-s/2, -s/2, s/2, s/2, squareStartHSB, squareEndHSB);
  rect(0, 0, s, s, 20);
  pop();
  myEffectShape.resetEffects(); // Always reset effects after use

  // --- Circle (RGB gradient, HSB shadow, WITH BLUR) ---
  push();
  translate(width * 0.5, height / 2);
  let r = 100;
  myEffectShape.setShadowColor(shadowColorHSB);
  myEffectShape.blur(true, 5); // Enable blur with 5px intensity for this object
  myEffectShape.applyEffects(); // Apply effects (shadow and blur)
  myEffectShape.linearGradient(-r, -r, r, r, circleStartRGB, circleEndRGB);
  ellipse(0, 0, r * 2);
  pop();
  myEffectShape.resetEffects(); // Always reset effects after use

  // --- Triangle (HSB gradient, HSB shadow, no blur) ---
  push();
  translate(width * 0.75, height / 2);
  rotate(frameCount * -0.3);
  let tSize = 180;
  myEffectShape.setShadowColor(shadowColorHSB);
  myEffectShape.blur(false); // Turn off blur for this object
  myEffectShape.applyEffects(); // Apply effects (shadow only)
  myEffectShape.linearGradient(-tSize/2, -tSize/2, tSize/2, tSize/2, triangleStartHSB, triangleEndHSB);
  triangle(
    0, -tSize / 2,
    -tSize / 2, tSize / 2,
    tSize / 2, tSize / 2
  );
  pop();
  myEffectShape.resetEffects(); // Always reset effects after use

  // --- Text (HSB color) ---
  noStroke();
  fill(0, 0, 100);
  textAlign(CENTER, CENTER);
  textSize(24);
  text("Square", width * 0.25, height / 2 + 150);
  text("Circle (with blur)", width * 0.5, height / 2 + 150);
  text("Triangle", width * 0.75, height / 2 + 150);
}

function mousePressed() {}
function mouseReleased() {}
</script>

</body>
</html>
